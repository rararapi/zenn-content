---
title: "動画の炎上リスクをAIが守る「Enjo-Guardian」"
emoji: "🎬"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["gch4", "googlecloud", "gemini", "AI", "動画解析"]
published: true
---

## はじめに

SNSで動画コンテンツが炎上するケースが後を絶ちません。投稿後に「意図せず差別的な表現が含まれていた」「過激な言葉遣いを指摘された」「誇張表現だとみなされた」といった問題が発覚し、炎上や謝罪につながる事例は企業・個人問わず増え続けています。

本プロジェクト **Enjo-Guardian** は、SNS投稿**前**に動画をAI解析し、炎上につながりうるリスク箇所をタイムスタンプ付きで自動検出するツールです。

https://www.youtube.com/watch?v=Zs_yAo0lvmw

---

## 対象ユーザーと解決する課題

### 対象ユーザー

- SNS（Twitter/X・Instagram・YouTube・TikTok）に動画を投稿するコンテンツクリエイター
- 企業のSNS担当者・マーケティングチーム
- ブランド・組織の広報担当者

### 解決する課題

| 課題                             | 従来の対応                           | Enjo-Guardianの対応                        |
| -------------------------------- | ------------------------------------ | ------------------------------------------ |
| 投稿前のリスク確認に工数がかかる | 人手でレビュー（見落としリスクあり） | AIが映像・音声・テキストを自動解析         |
| 動画内の特定箇所を特定しにくい   | 全体を再生して確認                   | タイムスタンプ付きでリスク箇所を特定       |
| リスクの種類・程度が分かりにくい | 担当者の主観に依存                   | スコア・カテゴリ別に定量評価               |
| 修正の二度手間                   | 編集ソフトに戻って再書き出し         | ブラウザ内統合エディタでその場で修正・出力 |

### 検出するリスクカテゴリ

1. **攻撃性** — 匿名性・拡散性を利用した煽り、個人攻撃を誘発する表現
2. **差別性** — 人種・性別・性的指向への偏見に基づく表現
3. **誤解を招く表現** — 断定的・誇張・ステレオタイプな言い回し
4. **迷惑行為** — 店舗・公共の場での不適切行為、器物損壊 

---

## ソリューションの特徴

### 1. マルチモーダル解析

動画の**映像・音声・テキスト**を統合的に解析します。Gemini 3 Pro APIが動画ファイルをそのまま受け取り、複数の観点から一括して炎上リスクを評価します。

### 2. タイムスタンプ付きリスク表示

リスクのある箇所はタイムスタンプ付きで一覧表示されます。クリックするとその箇所にシークできるため、修正が必要な部分を即座に確認できます。

### 3. リアルタイム進捗表示

解析はバックグラウンドで非同期実行されます。Server-Sent Events（SSE）により、解析フェーズ（音声解析→映像解析→リスク評価）の進捗がリアルタイムで表示されます。

### 4. 投稿コンテキストを加味した解析

動画の「用途」「投稿先媒体」「想定ターゲット層」をもとに、より文脈に即したリスク評価が可能です。

### 5. ブラウザ内動画編集機能

リスク検出後、**そのままブラウザ上で動画を編集・エクスポート**できる統合エディタを実装しました。解析結果から直接修正作業に移行できます。

---

## 動画編集機能（タイムラインエディタ）

リスク解析完了後、結果画面から**タイムラインエディタ**に遷移して動画を直接編集できます。

### エディタ画面

![](/images/editor-image.png)

### 5種類の編集アクション

各リスク箇所に対して、以下のアクションを選択して適用できます。

| アクション     | 内容                                                                   |
| -------------- | ---------------------------------------------------------------------- |
| **カット**     | 該当区間を映像ごと削除                                                 |
| **ミュート**   | 該当区間の音声を無音化                                                 |
| **モザイク**   | 指定領域をモザイク処理（位置・サイズ・強度を設定可）                   |
| **テロップ**   | 字幕テキストを重ねて表示（テキスト・位置・フォントサイズ・色を設定可） |
| **対応しない** | リスクを認識したうえでスキップ                                         |

### エクスポート処理フロー

```
1. 「エクスポート」ボタンをクリック
   └─ バックエンドで Celery タスクをキューに追加

2. ffmpeg による動画処理（バックグラウンド）
   ├─ カット区間の削除
   ├─ ミュート区間の音声マスク
   ├─ モザイクフィルタの適用
   └─ テロップ（drawtext）の合成

3. 完了後、MP4 ファイルをダウンロード
   └─ GCS に保存 → 署名付きURLで取得
```

進捗状況はポーリングにより2秒ごとに更新されます。

---

## システムアーキテクチャ

![](/images/architecture-image.png)

### インフラ構成（Google Cloud Platform）

| コンポーネント            | GCPサービス                       |
| ------------------------- | --------------------------------- |
| フロントエンド / API      | Cloud Run                         |
| ワーカー                  | Cloud Run（バックグラウンド処理） |
| データベース              | Cloud SQL（PostgreSQL 15）        |
| タスクキュー / キャッシュ | Memorystore（Redis）              |
| 動画ストレージ            | Cloud Storage                     |
| コンテナレジストリ        | Artifact Registry                 |
| シークレット管理          | Secret Manager                    |
| CI/CD                     | GitHub Actions + Terraform        |
| 認証連携                  | Workload Identity Federation      |

---

## 解析フロー

```
1. 動画アップロード
   └─ ファイルバリデーション（mp4, 最大100MB）
   └─ メタ情報入力（用途・投稿媒体・ターゲット層）

2. バックグラウンド解析（非同期）
   ├─ [並列] 音声解析
   │    └─ ffmpegで音声抽出
   │    └─ Cloud Speech-to-Text でテキスト化
   └─ [逐次] Gemini 動画解析
        └─ Gemini 3 Pro に動画を直接送信
        └─ 映像・テキスト・オブジェクト検出
        └─ リスク箇所をJSON形式で出力

3. 結果保存・表示
   └─ リスクアイテムをDBに保存
   └─ スコア・カテゴリ・タイムスタンプをフロントエンドに返却
```

---

## 技術スタック

| レイヤー       | 使用技術                                 |
| -------------- | ---------------------------------------- |
| フロントエンド | React 18, TypeScript, Vite, Tailwind CSS |
| バックエンド   | Python 3.12, FastAPI, Pydantic v2        |
| タスクキュー   | Celery 5, Redis 7                        |
| データベース   | PostgreSQL 15, SQLAlchemy 2.0, Alembic   |
| ストレージ     | MinIO（開発）/ Cloud Storage（本番）     |
| AI/ML          | Gemini 3 Pro, Cloud Speech-to-Text       |
| インフラ       | Cloud Run, Cloud SQL, Memorystore, GCS   |
| IaC            | Terraform                                |
| CI/CD          | GitHub Actions                           |

## プロダクトの特徴

### 課題の新規性

「投稿前の炎上リスク検知」に特化したツールは一般ユーザー向けにほとんど存在しません。チェックリスト型のガイドラインや人手レビューが主流のなか、**動画ファイルをそのままAIに投入して自動診断できる**点が新規性のポイントです。

### 解決策の有効性

- **Gemini 3 Pro** の動画理解能力（映像・音声・テキストの統合解析）を活用することで、人手では気づきにくいリスクも検出
- タイムスタンプによる**ピンポイントな修正支援**が実用的

### 実装品質と拡張性

- **サーバーレス**（Cloud Run）による自動スケーリングとコスト最適化
- 非同期処理（Celery + Redis）による**スケーラブルな処理基盤**
- IaC（Terraform）による**再現性の高いインフラ管理**
- 抽象化されたストレージレイヤーで**環境ごとの切り替えが容易**（MinIO↔GCS）

---

## おわりに

Enjo-Guardian は「炎上を防ぐ」という明確なユースケースに特化し、Gemini APIのマルチモーダル能力とGoogle Cloudのマネージドサービスを組み合わせて構築しました。

コンテンツクリエイターや企業のSNS担当者が、投稿前の最後のチェックとしてこのツールを活用することで、意図しない炎上リスクを大幅に低減できると考えています。
