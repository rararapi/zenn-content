---
title: "動画の炎上リスクをAIが守る「Enjo-Guardian」"
emoji: "🎬"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["gch4", "googlecloud", "gemini", "AI", "動画解析"]
published: false
---

## はじめに

SNSで動画コンテンツが炎上するケースが後を絶ちません。投稿後に「意図せず差別的な表現が含まれていた」「過激な言葉遣いを指摘された」「誇張表現だとみなされた」といった問題が発覚し、炎上や謝罪につながる事例は企業・個人問わず増え続けています。

本プロジェクト **Enjo-Guardian** は、SNS投稿**前**に動画をAI解析し、炎上につながりうるリスク箇所をタイムスタンプ付きで自動検出するツールです。

---

## 対象ユーザーと解決する課題

### 対象ユーザー

- SNS（Twitter/X・Instagram・YouTube・TikTok）に動画を投稿するコンテンツクリエイター
- 企業のSNS担当者・マーケティングチーム
- ブランド・組織の広報担当者

### 解決する課題

| 課題                               | 従来の対応                           | Video Risk Analyzerの対応              |
| ---------------------------------- | ------------------------------------ | -------------------------------------- |
| 投稿前のリスク確認に工数がかかる   | 人手でレビュー（見落としリスクあり） | AIが映像・音声・テキストを自動解析     |
| 動画内の特定箇所を特定しにくい     | 全体を再生して確認                   | タイムスタンプ付きでリスク箇所を特定   |
| リスクの種類・程度が分かりにくい   | 担当者の主観に依存                   | スコア・カテゴリ別に定量評価           |
| 投稿先・ターゲット層を考慮しにくい | ケースバイケースで対応               | 投稿媒体・ターゲット情報を加味した解析 |

### 検出するリスクカテゴリ

1. **攻撃性** — 攻撃的・過激な表現、威圧的な言葉遣い
2. **差別性** — 人種・性別・性的指向などへの偏見・差別的表現
3. **誤解を招く表現** — 断定的・誇張・ステレオタイプに基づく表現
4. **迷惑行為・不衛生行為** — 公共の場での不適切行動、食品への不衛生な行為、器物損壊

---

## ソリューションの特徴

### 1. マルチモーダル解析

動画の**映像・音声・テキスト（字幕・看板等）**を統合的に解析します。Gemini 3 Pro APIが動画ファイルをそのまま受け取り、複数の観点から一括して炎上リスクを評価します。

### 2. タイムスタンプ付きリスク表示

リスクのある箇所はタイムスタンプ付きで一覧表示されます。クリックするとその箇所にシークできるため、修正が必要な部分を即座に確認できます。

### 3. リアルタイム進捗表示

解析はバックグラウンドで非同期実行されます。Server-Sent Events（SSE）により、解析フェーズ（音声解析→映像解析→リスク評価）の進捗がリアルタイムで表示されます。

### 4. 投稿コンテキストを加味した解析

動画の「用途」「投稿先媒体」「想定ターゲット層」をもとに、より文脈に即したリスク評価が可能です。

### 5. ブラウザ内動画編集機能

リスク検出後、**そのままブラウザ上で動画を編集・エクスポート**できる統合エディタを実装しました。解析結果から直接修正作業に移行できます。

---

## 動画編集機能（タイムラインエディタ）

リスク解析完了後、結果画面から**タイムラインエディタ**に遷移して動画を直接編集できます。

### エディタの構成

```
┌──────────────────────────────────────────────────────────┐
│  ヘッダー: 保存 / Undo / エクスポートボタン・進捗表示     │
├──────────────────────────┬───────────────────────────────┤
│                          │  編集提案パネル（サイドバー）  │
│  動画プレビュー          │  ・高リスク箇所リスト         │
│  ・カット予定範囲を表示  │  ・リスクスコア・理由         │
│                          │  ・5種類の編集アクション      │
├──────────────────────────┤  ・プレビュー / 適用ボタン   │
│  再生コントロール        │                               │
│  ・再生/一時停止         │                               │
│  ・±5秒スキップ          │                               │
│  ・シークバー / ミュート │                               │
├──────────────────────────┴───────────────────────────────┤
│  リスクグラフ（SVG折れ線グラフ）                         │
│  ・リスクスコア推移 / 高リスク帯の強調表示               │
├──────────────────────────────────────────────────────────┤
│  タイムライン                                            │
│  ・カット範囲（赤）/ 提案箇所（黄）/ 現在位置カーソル    │
└──────────────────────────────────────────────────────────┘
```

### 5種類の編集アクション

各リスク箇所に対して、以下のアクションを選択して適用できます。

| アクション     | 内容                                                                   |
| -------------- | ---------------------------------------------------------------------- |
| **カット**     | 該当区間を映像ごと削除                                                 |
| **ミュート**   | 該当区間の音声を無音化                                                 |
| **モザイク**   | 指定領域をモザイク処理（位置・サイズ・強度を設定可）                   |
| **テロップ**   | 字幕テキストを重ねて表示（テキスト・位置・フォントサイズ・色を設定可） |
| **対応しない** | リスクを認識したうえでスキップ                                         |

### エクスポート処理フロー

```
1. 「エクスポート」ボタンをクリック
   └─ バックエンドで Celery タスクをキューに追加

2. ffmpeg による動画処理（バックグラウンド）
   ├─ カット区間の削除
   ├─ ミュート区間の音声マスク
   ├─ モザイクフィルタの適用
   └─ テロップ（drawtext）の合成

3. 完了後、MP4 ファイルをダウンロード
   └─ GCS に保存 → 署名付きURLで取得
```

進捗状況はポーリングにより2秒ごとに更新されます。

---

## デモ動画

※デモ動画は準備中です。

---

## システムアーキテクチャ

```
┌──────────────────────────────────────────────────────────┐
│                    ユーザーブラウザ                        │
│  React 18 + TypeScript (Vite)                            │
│  ・動画アップロード（ドラッグ&ドロップ）                    │
│  ・リアルタイム進捗表示（SSE）                             │
│  ・リスク結果表示（タイムスタンプ付き動画プレイヤー）        │
└─────────────────────┬────────────────────────────────────┘
                      │ HTTP / SSE
┌─────────────────────▼────────────────────────────────────┐
│                  Backend API                              │
│  Python 3.12 + FastAPI (Cloud Run)                       │
│  ・POST /api/videos   動画アップロード・ジョブ作成          │
│  ・GET  /api/jobs/:id/events  SSEストリーミング            │
│  ・GET  /api/jobs/:id/results 解析結果取得                 │
└──────┬─────────────────────────────┬────────────────────┘
       │ Celery タスクキュー          │ PostgreSQL (Cloud SQL)
┌──────▼──────────────┐  ┌──────────▼────────────────────┐
│    Worker           │  │  Database                     │
│  Celery 5 (Cloud Run│  │  ・videos テーブル             │
│  ・解析パイプライン  │  │  ・analysis_jobs テーブル      │
│    実行             │  │  ・risk_items テーブル         │
└──────┬──────────────┘  └───────────────────────────────┘
       │
       │  Redis (Memorystore)
       │  ・タスクキュー
       │  ・進捗状態管理
       │
┌──────▼──────────────────────────────────────────────────┐
│               Google Cloud AI Services                   │
│                                                          │
│  ┌─────────────────────┐  ┌────────────────────────┐   │
│  │  Gemini 3 Pro       │  │  Cloud Speech-to-Text  │   │
│  │  ・映像解析          │  │  ・音声書き起こし       │   │
│  │  ・OCRテキスト検出   │  │  ・日本語対応           │   │
│  │  ・リスク評価        │  │  ・話者分離             │   │
│  └─────────────────────┘  └────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
       │
┌──────▼──────────────────────────────────────────────────┐
│               Storage                                    │
│  Cloud Storage (GCS)  ※開発環境は MinIO                 │
│  ・動画ファイル保存（7日間ライフサイクル）                  │
└─────────────────────────────────────────────────────────┘
```

### インフラ構成（Google Cloud Platform）

| コンポーネント            | GCPサービス                       |
| ------------------------- | --------------------------------- |
| フロントエンド / API      | Cloud Run                         |
| ワーカー                  | Cloud Run（バックグラウンド処理） |
| データベース              | Cloud SQL（PostgreSQL 15）        |
| タスクキュー / キャッシュ | Memorystore（Redis）              |
| 動画ストレージ            | Cloud Storage                     |
| コンテナレジストリ        | Artifact Registry                 |
| シークレット管理          | Secret Manager                    |
| CI/CD                     | GitHub Actions + Terraform        |
| 認証連携                  | Workload Identity Federation      |

---

## 解析フロー

```
1. 動画アップロード
   └─ ファイルバリデーション（mp4, 最大100MB）
   └─ メタ情報入力（用途・投稿媒体・ターゲット層）

2. バックグラウンド解析（非同期）
   ├─ [並列] 音声解析
   │    └─ ffmpegで音声抽出
   │    └─ Cloud Speech-to-Text でテキスト化
   └─ [逐次] Gemini 動画解析
        └─ Gemini 3 Pro に動画を直接送信
        └─ 映像・テキスト・オブジェクト検出
        └─ リスク箇所をJSON形式で出力

3. 結果保存・表示
   └─ リスクアイテムをDBに保存
   └─ スコア・カテゴリ・タイムスタンプをフロントエンドに返却
```

---

## 技術スタック

| レイヤー       | 使用技術                                 |
| -------------- | ---------------------------------------- |
| フロントエンド | React 18, TypeScript, Vite, Tailwind CSS |
| バックエンド   | Python 3.12, FastAPI, Pydantic v2        |
| タスクキュー   | Celery 5, Redis 7                        |
| データベース   | PostgreSQL 15, SQLAlchemy 2.0, Alembic   |
| ストレージ     | MinIO（開発）/ Cloud Storage（本番）     |
| AI/ML          | Gemini 3 Pro, Cloud Speech-to-Text       |
| インフラ       | Cloud Run, Cloud SQL, Memorystore, GCS   |
| IaC            | Terraform                                |
| CI/CD          | GitHub Actions                           |

---

## 使い方

1. 動画ファイル（mp4）をアップロード画面にドラッグ&ドロップ
2. 「解析を開始」をクリック
3. 解析フェーズの進捗をリアルタイム確認
4. 完了後、リスク箇所をタイムスタンプ付きで確認・修正

---

## 審査基準との対応

### 課題の新規性

「投稿前の炎上リスク検知」に特化したツールは一般ユーザー向けにほとんど存在しません。チェックリスト型のガイドラインや人手レビューが主流のなか、**動画ファイルをそのままAIに投入して自動診断できる**点が新規性のポイントです。

### 解決策の有効性

- **Gemini 3 Pro** の動画理解能力（映像・音声・テキストの統合解析）を活用することで、人手では気づきにくいリスクも検出
- タイムスタンプによる**ピンポイントな修正支援**が実用的
- 投稿媒体・ターゲット層を考慮した**コンテキスト依存の評価**

### 実装品質と拡張性

- **サーバーレス**（Cloud Run）による自動スケーリングとコスト最適化
- 非同期処理（Celery + Redis）による**スケーラブルな処理基盤**
- IaC（Terraform）による**再現性の高いインフラ管理**
- 抽象化されたストレージレイヤーで**環境ごとの切り替えが容易**（MinIO↔GCS）
- pytest・Vitest による**テスト整備**

---

## おわりに

Enjo-Guardian は「炎上を防ぐ」という明確なユースケースに特化し、Gemini APIのマルチモーダル能力とGoogle Cloudのマネージドサービスを組み合わせて構築しました。

コンテンツクリエイターや企業のSNS担当者が、投稿前の最後のチェックとしてこのツールを活用することで、意図しない炎上リスクを大幅に低減できると考えています。
